/*
  ==============================================================================

    LowPassFilter.h
    Created: 11 Jan 2022 10:26:55pm
    Author:  Tommy Rushton

  ==============================================================================
*/

#pragma once

#include <JuceHeader.h>

class LowPassFilter {
public:
    LowPassFilter();

    void clear() noexcept;

    float processSample(float input) noexcept;

    void processBlock(juce::AudioBuffer<float> buffer, int numSamples);

private:
//    const double b0{8.80046409745677e-05};
//    const std::vector<double> bCoeff{
//            0.00140807425559308, 0.0105605569169481, 0.0492825989457579, 0.160168446573713, 0.384404271776912,
//            0.704741164924338, 1.00677309274905, 1.13261972934269, 1.00677309274905, 0.704741164924338,
//            0.384404271776912, 0.160168446573713, 0.0492825989457579, 0.0105605569169481, 0.00140807425559308,
//            8.80046409745677e-05
//    };
//    const std::vector<double> aCoeff{
//            -2.67732545660392e-15, 2.16964477543704, -4.20828990548919e-15, 1.76504194938032, -1.75297444707951e-15,
//            0.685302479580568, 5.73987936236921e-16, 0.134084268528723, 6.49025897555478e-16, 0.0128506295130287,
//            9.02436423742187e-17, 0.000540383728671063, -1.31607067733054e-17, 7.64925129563502e-06,
//            -9.60372445660347e-19, 1.54896336661535e-08
//    };

    const double b0{5.28259698592647e-06};
    const std::vector<double> bCoeff{
            8.45215517748333e-05, 0.000633911638311130, 0.00295825431211908, 0.00961432651438652,
            0.0230743836345242, 0.0423030366633137, 0.0604329095189747, 0.0679870232089084,
            0.0604329095189743, 0.0423030366633131, 0.0230743836345240, 0.00961432651438655,
            0.00295825431211908, 0.000633911638311132, 8.45215517748334e-05, 5.28259698592648e-06
    };
    const std::vector<double> aCoeff{
            -3.19521488912082, 6.77953596783366, -9.87172854286193, 11.2169376528220,
            -10.0673291486601, 7.38059581189452, -4.43128061348800, 2.19705210639356,
            -0.894788775962766, 0.297693188763969, -0.0796486303055283, 0.0167692188461068,
            -0.00267675756432274, 0.000305039582274487, -2.21200962727910e-05, 7.67993309473310e-07
    };

//    const double b0{1};
//    const std::vector<double> aCoeff{
//            0.0, 0.0, 0.0, 0.0,
//            0.0, 0.0, 0.0, 0.0,
//            0.0, 0.0, 0.0, 0.0,
//            0.0, 0.0, 0.0, 0.0,
//    };
//    const std::vector<double> bCoeff{
//            0.0, 0.0, 0.0, 0.0,
//            0.0, 0.0, 0.0, 0.0,
//            0.0, 0.0, 0.0, 0.0,
//            0.0, 0.0, 0.0, 0.0,
//    };

    std::vector<double> xPrev, yPrev;
};
